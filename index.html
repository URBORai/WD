<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOM  &   JOY - é›»å­å–œå¸–</title>

    <!-- AOS CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

    <!-- Hammer.js - è§¸æ§æ‰‹å‹¢åº« -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

    <!-- è‡ªè¨‚æ¨£å¼ -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- å›ºå®šå¼å°èˆªåˆ— -->
    <nav class="main-nav">
        <a href="#hero" class="nav-link">é¦–é </a>
        <a href="#about" class="nav-link">é—œæ–¼æˆ‘å€‘</a>
        <a href="#timeline" class="nav-link">å©šç¦®é€²ç¨‹</a>
        <a href="#guestbook" class="nav-link">ç•™è¨€ç¥ç¦</a>
        <a href="#links" class="nav-link" id="rsvp-or-schedule-link">å›è¦†å‡ºå¸­</a>
        <a href="#venue" class="nav-link">åœ°é»</a>
        <a href="#paper-invitation" class="nav-link">ç´™æœ¬å–œå¸–</a>
        <button id="music-toggle" class="music-btn" aria-label="æ’­æ”¾/æš«åœéŸ³æ¨‚">
            <span class="music-icon">ğŸ”‡</span>
        </button>
    </nav>

    <!-- éš±è—çš„èƒŒæ™¯éŸ³æ¨‚ -->
    <audio id="bg-music" loop>
        <source src="" type="audio/mpeg">
        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³è¨Šæ’­æ”¾ã€‚
    </audio>

    <!-- ä¸»è¦å…§å®¹å€ -->

    <!-- é¦–é å€å¡Š -->
    <section id="hero" class="hero-section">
        <div class="hero-content" data-aos="fade-up" data-aos-duration="1200">
            <h1 class="couple-names"></h1>
            <p class="wedding-date"></p>
            <p class="tagline">èª æ‘¯é‚€è«‹æ‚¨è¦‹è­‰æˆ‘å€‘çš„å¹¸ç¦æ™‚åˆ»</p>
        </div>
    </section>

    <!-- æ–°äººä»‹ç´¹å€å¡Š -->
    <section id="profile" class="profile-section">
        <div class="profile-container">
            <h2 data-aos="fade-up">èªè­˜æˆ‘å€‘</h2>

            <!-- åˆ‡æ›æŒ‰éˆ• -->
            <div class="profile-toggle" data-aos="fade-up" data-aos-delay="100">
                <button class="toggle-btn active" data-profile="groom">æ–°éƒ</button>
                <button class="toggle-btn" data-profile="bride">æ–°å¨˜</button>
            </div>

            <!-- å€‹äººä»‹ç´¹å¡ç‰‡å®¹å™¨ -->
            <div class="profile-cards-wrapper">
                <!-- æ–°éƒå¡ç‰‡ -->
                <div class="profile-card active" id="groom-card">
                    <div class="profile-photo">
                        <img src="" alt="æ–°éƒç…§ç‰‡" id="groom-photo">
                    </div>
                    <div class="profile-info">
                        <h3 class="profile-name" id="groom-name"></h3>
                        <p class="profile-title" id="groom-title"></p>
                        <p class="profile-description" id="groom-description"></p>
                        <div class="profile-hobbies">
                            <h4>æ›¾ç¶“å±…ä½åœ°</h4>
                            <div class="hobbies-list" id="groom-hobbies"></div>
                        </div>
                        <blockquote class="profile-quote" id="groom-quote"></blockquote>
                    </div>
                </div>

                <!-- æ–°å¨˜å¡ç‰‡ -->
                <div class="profile-card" id="bride-card">
                    <div class="profile-photo">
                        <img src="" alt="æ–°å¨˜ç…§ç‰‡" id="bride-photo">
                    </div>
                    <div class="profile-info">
                        <h3 class="profile-name" id="bride-name"></h3>
                        <p class="profile-title" id="bride-title"></p>
                        <p class="profile-description" id="bride-description"></p>
                        <div class="profile-hobbies">
                            <h4>æ›¾ç¶“å±…ä½åœ°</h4>
                            <div class="hobbies-list" id="bride-hobbies"></div>
                        </div>
                        <blockquote class="profile-quote" id="bride-quote"></blockquote>
                    </div>
                </div>
            </div>

            <!-- å·¦å³åˆ‡æ›ç®­é ­ -->
            <div class="profile-arrows">
                <button class="arrow-btn prev-btn" id="prev-profile">â€¹</button>
                <button class="arrow-btn next-btn" id="next-profile">â€º</button>
            </div>
        </div>
    </section>

    <!-- é—œæ–¼æˆ‘å€‘å€å¡Š -->
    <section id="about" class="about-section">
        <div class="split-container">
            <div class="split-content" data-aos="fade-right">
                <h2>æˆ‘å€‘æœªå®Œå¾…çºŒçš„æ•…äº‹</h2>
                <p>ç¥çš„é…åˆçœŸçš„å¤ªå¥‡å¦™ï¼Œåœ¨ç¥çš„å®¶ä¸­èªè­˜ä¸¦ä¸”å¦‚ä»Šèƒ½åœ¨ç¥çš„æ„›ä¸­å…±æ‰¿ç”Ÿå‘½ä¹‹æ©ï¼Œå³ä½¿çœ‹èµ·ä¾†æ˜¯è¿¥ç„¶ä¸åŒçš„å…©äººï¼Œä½†ä¸€åˆ‡éƒ½æ˜¯é‚£éº¼çš„å‰›å¥½ï¼Œå¾ˆé–‹å¿ƒèƒ½èˆ‡ä½ å€‘åˆ†äº«é€™ä»½å–œæ‚…ï¼Œè¬è¬ä½ å€‘ï¼</p>
                <div class="wedding-info-inline">
                    <div class="info-item">
                        <h3>å©šç¦®æ—¥æœŸ</h3>
                        <p class="wedding-date-info"></p>
                    </div>
                    <div class="info-item">
                        <h3>èˆ‰è¡Œæ™‚é–“</h3>
                        <p class="wedding-time-info"></p>
                    </div>
                </div>
            </div>
            <div class="split-image slideshow-container" data-aos="fade-left">
                <!-- å¹»ç‡ˆç‰‡å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
    </section>

    <!-- å©šç¦®é€²ç¨‹å€å¡Š -->
    <section id="timeline" class="timeline-section">
        <div class="timeline-content">
            <h2 data-aos="fade-up">å©šç¦®é€²ç¨‹</h2>
            <p class="timeline-intro-text" data-aos="fade-up" data-aos-delay="100"><strong>é—œæ–¼2/8é€™ä¸€ç« çš„æ•…äº‹</strong></p>
            <div class="timeline-wrapper">
                <!-- Timeline é …ç›®å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
            <p class="timeline-closing-text" data-aos="fade-up"><strong>æˆ‘å€‘çš„æ•…äº‹å°‡æŒçºŒä¸‹å»...</strong></p>
        </div>
    </section>

    <!-- RSVP / é€£çµå€å¡Š -->
    <section id="links" class="links-section">
        <h2 data-aos="fade-up">å›è¦†å‡ºå¸­</h2>
        <div class="link-cards">
            <a href="" target="_blank" class="link-box old-invitation-link" data-aos="fade-up" data-aos-delay="100">
                <div class="card-icon">ğŸ’Œ</div>
                <h3>æŸ¥çœ‹èˆŠç‰ˆ</h3>
                <p>èˆŠç‰ˆé›»å­ç¶²ç«™</p>
            </a>
            <a href="#paper-invitation" class="link-box paper-invitation-link" data-aos="fade-up" data-aos-delay="200">
                <div class="card-icon">ğŸ’</div>
                <h3>é›»å­å–œå¸–</h3>
                <p>æŸ¥çœ‹ç´™æœ¬å–œå¸–é è¦½</p>
            </a>
            <a href="" target="_blank" class="link-box rsvp-form-link" data-aos="fade-up" data-aos-delay="300">
                <div class="card-icon">ğŸ“</div>
                <h3>å¡«å¯«å›è¦†è¡¨å–®</h3>
                <p>è«‹å‘Šè¨´æˆ‘å€‘æ‚¨æ˜¯å¦èƒ½åƒåŠ </p>
            </a>
        </div>
    </section>

    <!-- ç•™è¨€æ¿å€å¡Š -->
    <section id="guestbook" class="guestbook-section">
        <div class="guestbook-container">
            <h2 data-aos="fade-up">ç•™è¨€ç¥ç¦</h2>
            <p class="guestbook-subtitle" data-aos="fade-up" data-aos-delay="100">
                ç•™ä¸‹æ‚¨çš„ç¥ç¦,èˆ‡æˆ‘å€‘åˆ†äº«å–œæ‚…
            </p>

            <!-- ç™¼è¡¨ç•™è¨€è¡¨å–® -->
            <div class="message-form-wrapper" data-aos="fade-up" data-aos-delay="200">
                <form id="message-form" class="message-form">
                    <input
                        type="text"
                        id="author-input"
                        placeholder="æ‚¨çš„æš±ç¨±ï¼ˆé¸å¡«ï¼Œæœ€å¤š30å­—ï¼‰"
                        maxlength="30"
                    />

                    <!-- é ­åƒé¸æ“‡å™¨ -->
                    <div class="avatar-selector">
                        <label class="avatar-label">é¸æ“‡æ‚¨çš„é ­åƒï¼š</label>
                        <div class="avatar-options">
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="ğŸ˜Š" checked>
                                <span class="avatar-icon">ğŸ˜Š</span>
                            </label>
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="ğŸ¥°">
                                <span class="avatar-icon">ğŸ¥°</span>
                            </label>
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="ğŸ˜">
                                <span class="avatar-icon">ğŸ˜</span>
                            </label>
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="ğŸ¤—">
                                <span class="avatar-icon">ğŸ¤—</span>
                            </label>
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="ğŸŒŸ">
                                <span class="avatar-icon">ğŸŒŸ</span>
                            </label>
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="ğŸ’">
                                <span class="avatar-icon">ğŸ’</span>
                            </label>
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="ğŸ‰">
                                <span class="avatar-icon">ğŸ‰</span>
                            </label>
                            <label class="avatar-option">
                                <input type="radio" name="avatar" value="â¤ï¸">
                                <span class="avatar-icon">â¤ï¸</span>
                            </label>
                        </div>
                    </div>

                    <textarea
                        id="message-input"
                        placeholder="å¯«ä¸‹æ‚¨çš„ç¥ç¦..."
                        maxlength="200"
                        required
                    ></textarea>
                    <div class="form-footer">
                        <span class="char-count">0 / 200</span>
                        <button type="submit" class="submit-btn">
                            <span class="btn-text">é€å‡ºç¥ç¦</span>
                            <span class="btn-loading" style="display: none;">å‚³é€ä¸­...</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- ç•™è¨€åˆ—è¡¨ -->
            <div class="messages-list" id="messages-list" data-aos="fade-up" data-aos-delay="300">
                <div class="loading-spinner">è¼‰å…¥ä¸­...</div>
            </div>
        </div>
    </section>

    <!-- åœ°é»å€å¡Š -->
    <section id="venue" class="venue-section">
        <div class="venue-container">
            <h2 data-aos="fade-up">åœ°é»</h2>

            <!-- å¿«é€Ÿå®šä½æŒ‰éˆ• -->
            <div class="location-buttons" data-aos="fade-up" data-aos-delay="100">
                <!-- åœ°é»æŒ‰éˆ•å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>

            <!-- åœ°åœ–é è¦½ -->
            <div class="map-preview" data-aos="fade-up" data-aos-delay="200">
                <iframe
                    id="venue-map"
                    src=""
                    width="100%"
                    height="100%"
                    style="border:0;"
                    allowfullscreen=""
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade">
                </iframe>
            </div>
        </div>
    </section>

    <!-- é å°¾ -->
    <footer class="footer">
        <p>æœŸå¾…èˆ‡æ‚¨ç›¸è¦‹ â¤ï¸</p>
        <p class="small-text">æ„Ÿè¬æ‚¨æ’¥å†—åƒåŠ </p>
    </footer>

    <!-- Lightbox å…¨è¢å¹•é è¦½ -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-close" onclick="closeLightbox()">Ã—</div>
        <div class="lightbox-prev" onclick="changeLightboxImage(-1)">â€¹</div>
        <div class="lightbox-next" onclick="changeLightboxImage(1)">â€º</div>
        <div class="lightbox-content">
            <img id="lightbox-img" src="" alt="é è¦½åœ–ç‰‡">
        </div>
        <div class="lightbox-counter">
            <span id="lightbox-current">1</span> / <span id="lightbox-total">1</span>
        </div>
    </div>

    <!-- ç´™æœ¬å–œå¸– Lightbox -->
    <div class="paper-invitation-lightbox" id="paper-invitation-lightbox">
        <div class="lightbox-close" onclick="closePaperInvitation()">Ã—</div>
        <div class="lightbox-prev" onclick="changePaperInvitationImage(-1)">â€¹</div>
        <div class="lightbox-next" onclick="changePaperInvitationImage(1)">â€º</div>
        <div class="lightbox-content">
            <img id="paper-invitation-img" src="" alt="ç´™æœ¬å–œå¸–">
        </div>
        <div class="lightbox-counter">
            <span id="paper-invitation-current">1</span> / <span id="paper-invitation-total">2</span>
        </div>
        <div class="lightbox-hint">
            ğŸ’¡ æ‰‹æ©Ÿï¼šå·¦å³æ»‘å‹•åˆ‡æ› Â· é›™æŒ‡ç¸®æ”¾æŸ¥çœ‹ Â· é›™æ“Šå¿«é€Ÿç¸®æ”¾<br>
            é›»è…¦ï¼šå·¦å³éµåˆ‡æ› Â· æ»‘é¼ æ»¾è¼ªç¸®æ”¾ Â· ESC é—œé–‰
        </div>
    </div>

    <!-- å„€ç¯€è¡¨ Lightbox -->
    <div class="ceremony-schedule-lightbox" id="ceremony-schedule-lightbox">
        <div class="lightbox-close" onclick="closeCeremonySchedule()">Ã—</div>
        <div class="lightbox-prev" onclick="changeCeremonyScheduleImage(-1)">â€¹</div>
        <div class="lightbox-next" onclick="changeCeremonyScheduleImage(1)">â€º</div>
        <div class="lightbox-content">
            <img id="ceremony-schedule-img" src="" alt="å©šç¦®å„€ç¯€è¡¨">
        </div>
        <div class="lightbox-counter">
            <span id="ceremony-schedule-current">1</span> / <span id="ceremony-schedule-total">2</span>
        </div>
        <div class="lightbox-hint">
            ğŸ’¡ æ‰‹æ©Ÿï¼šå·¦å³æ»‘å‹•åˆ‡æ› Â· é›™æŒ‡ç¸®æ”¾æŸ¥çœ‹<br>
            é›»è…¦ï¼šå·¦å³éµåˆ‡æ› Â· ESC é—œé–‰
        </div>
    </div>

    <!-- é…ç½®æª” -->
    <script src="config.js"></script>

    <!-- AOS JavaScript -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <!-- SweetAlert2 JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Supabase JavaScript SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- è‡ªè¨‚ JavaScript -->
    <script>
        // ä½¿ç”¨é…ç½®æª”åˆå§‹åŒ–é é¢å…§å®¹
        function initPageContent() {
            // æ›´æ–°æ–°äººåå­—
            document.querySelector('.couple-names').textContent =
                CONFIG.couple.groom + CONFIG.couple.separator + CONFIG.couple.bride;

            // æ›´æ–°å©šç¦®æ—¥æœŸ
            document.querySelector('.wedding-date').textContent = CONFIG.wedding.date;

            // æ›´æ–°å©šç¦®è³‡è¨Š
            document.querySelector('.wedding-date-info').textContent =
                `${CONFIG.wedding.date}(${CONFIG.wedding.dayOfWeek})`;
            document.querySelector('.wedding-time-info').textContent = CONFIG.wedding.time;

            // åˆå§‹åŒ–å¹»ç‡ˆç‰‡
            initSlideshow();

            // åˆå§‹åŒ–å€‹äººä»‹ç´¹
            initProfiles();

            // å‹•æ…‹ç”Ÿæˆ Timeline
            generateTimeline();

            // æ›´æ–°é€£çµ
            document.querySelector('.rsvp-form-link').href = CONFIG.links.rsvpForm;
            document.querySelector('.old-invitation-link').href = CONFIG.links.oldInvitation;

            // å‹•æ…‹ç”Ÿæˆåœ°é»æŒ‰éˆ•
            generateVenueButtons();

            // æ›´æ–°éŸ³æ¨‚ä¾†æº
            document.querySelector('#bg-music source').src = CONFIG.music.filename;
            document.getElementById('bg-music').load();
        }

        // å‹•æ…‹ç”Ÿæˆ Timeline
        function generateTimeline() {
            const timelineWrapper = document.querySelector('.timeline-wrapper');
            timelineWrapper.innerHTML = ''; // æ¸…ç©ºç¾æœ‰å…§å®¹

            CONFIG.timeline.forEach((item, index) => {
                const delay = (index + 1) * 100; // æ¯å€‹é …ç›®å»¶é² 100ms
                const timelineItem = `
                    <div class="timeline-item" data-aos="fade-up" data-aos-delay="${delay}">
                        <div class="timeline-marker">
                            <div class="timeline-dot"></div>
                        </div>
                        <div class="timeline-info">
                            <span class="timeline-time">${item.time}</span>
                            <div class="timeline-details">
                                <h3>${item.title}</h3>
                                <p>${item.description}</p>
                            </div>
                        </div>
                    </div>
                `;
                timelineWrapper.innerHTML += timelineItem;
            });
        }

        // å‹•æ…‹ç”Ÿæˆåœ°é»æŒ‰éˆ•
        function generateVenueButtons() {
            const locationButtons = document.querySelector('.location-buttons');
            locationButtons.innerHTML = ''; // æ¸…ç©ºç¾æœ‰å…§å®¹

            let isFirst = true;
            for (const [key, venue] of Object.entries(CONFIG.venues)) {
                const button = document.createElement('button');
                button.className = 'location-btn' + (isFirst ? ' active' : '');
                button.setAttribute('data-location', key);
                button.textContent = `${venue.icon} ${venue.name}`;
                locationButtons.appendChild(button);
                isFirst = false;
            }
        }

        // åˆå§‹åŒ–å€‹äººä»‹ç´¹
        let currentProfile = 'groom'; // ç•¶å‰é¡¯ç¤ºçš„ä»‹ç´¹ï¼ˆgroom æˆ– brideï¼‰

        function initProfiles() {
            // å¡«å……æ–°éƒè³‡æ–™
            document.getElementById('groom-photo').src = CONFIG.couple.groomProfile.photo;
            document.getElementById('groom-name').textContent = CONFIG.couple.groomProfile.name;
            document.getElementById('groom-title').textContent = CONFIG.couple.groomProfile.title;
            document.getElementById('groom-description').textContent = CONFIG.couple.groomProfile.description;
            document.getElementById('groom-quote').textContent = CONFIG.couple.groomProfile.quote;

            // ç”Ÿæˆæ–°éƒèˆˆè¶£æ¨™ç±¤
            const groomHobbies = document.getElementById('groom-hobbies');
            groomHobbies.innerHTML = '';
            CONFIG.couple.groomProfile.hobbies.forEach(hobby => {
                const tag = document.createElement('span');
                tag.className = 'hobby-tag';
                tag.textContent = hobby;
                groomHobbies.appendChild(tag);
            });

            // å¡«å……æ–°å¨˜è³‡æ–™
            document.getElementById('bride-photo').src = CONFIG.couple.brideProfile.photo;
            document.getElementById('bride-name').textContent = CONFIG.couple.brideProfile.name;
            document.getElementById('bride-title').textContent = CONFIG.couple.brideProfile.title;
            document.getElementById('bride-description').textContent = CONFIG.couple.brideProfile.description;
            document.getElementById('bride-quote').textContent = CONFIG.couple.brideProfile.quote;

            // ç”Ÿæˆæ–°å¨˜èˆˆè¶£æ¨™ç±¤
            const brideHobbies = document.getElementById('bride-hobbies');
            brideHobbies.innerHTML = '';
            CONFIG.couple.brideProfile.hobbies.forEach(hobby => {
                const tag = document.createElement('span');
                tag.className = 'hobby-tag';
                tag.textContent = hobby;
                brideHobbies.appendChild(tag);
            });

            // åˆå§‹åŒ–åˆ‡æ›æŒ‰éˆ•äº‹ä»¶
            initProfileToggle();
        }

        function initProfileToggle() {
            const toggleButtons = document.querySelectorAll('.toggle-btn');
            const prevBtn = document.getElementById('prev-profile');
            const nextBtn = document.getElementById('next-profile');

            // åˆ‡æ›æŒ‰éˆ•é»æ“Šäº‹ä»¶
            toggleButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const targetProfile = this.getAttribute('data-profile');
                    if (targetProfile !== currentProfile) {
                        switchProfile(targetProfile);
                    }
                });
            });

            // å·¦ç®­é ­ï¼ˆåˆ‡æ›åˆ°ä¸Šä¸€å€‹ï¼‰
            prevBtn.addEventListener('click', function() {
                const targetProfile = currentProfile === 'groom' ? 'bride' : 'groom';
                switchProfile(targetProfile);
            });

            // å³ç®­é ­ï¼ˆåˆ‡æ›åˆ°ä¸‹ä¸€å€‹ï¼‰
            nextBtn.addEventListener('click', function() {
                const targetProfile = currentProfile === 'groom' ? 'bride' : 'groom';
                switchProfile(targetProfile);
            });
        }

        function switchProfile(targetProfile) {
            // å¦‚æœå·²ç¶“æ˜¯ç•¶å‰ profileï¼Œä¸åšä»»ä½•äº‹
            if (targetProfile === currentProfile) {
                return;
            }

            const groomCard = document.getElementById('groom-card');
            const brideCard = document.getElementById('bride-card');
            const toggleButtons = document.querySelectorAll('.toggle-btn');

            // æ›´æ–°åˆ‡æ›æŒ‰éˆ•ç‹€æ…‹
            toggleButtons.forEach(btn => {
                if (btn.getAttribute('data-profile') === targetProfile) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // å…ˆç§»é™¤ç•¶å‰é¡¯ç¤ºçš„å¡ç‰‡
            groomCard.classList.remove('active');
            brideCard.classList.remove('active');

            // çŸ­æš«å»¶é²å¾Œé¡¯ç¤ºç›®æ¨™å¡ç‰‡ï¼ˆè®“å‹•ç•«æ›´æµæš¢ï¼‰
            setTimeout(() => {
                if (targetProfile === 'groom') {
                    groomCard.classList.add('active');
                } else {
                    brideCard.classList.add('active');
                }
            }, 50);

            currentProfile = targetProfile;
        }

        // åˆå§‹åŒ–å¹»ç‡ˆç‰‡
        let currentSlide = 0;
        let slideInterval;

        function initSlideshow() {
            const container = document.querySelector('.slideshow-container');
            if (!container || !CONFIG.slideshow || !CONFIG.slideshow.images.length) return;

            // æ¸…ç©ºå®¹å™¨
            container.innerHTML = '';

            // å‰µå»ºå¹»ç‡ˆç‰‡
            CONFIG.slideshow.images.forEach((image, index) => {
                const slide = document.createElement('div');
                slide.className = 'slideshow-slide' + (index === 0 ? ' active' : '');
                slide.innerHTML = `<img src="${image}" alt="æ–°äººç…§ç‰‡ ${index + 1}">`;
                slide.addEventListener('click', () => openLightbox(index));
                container.appendChild(slide);
            });

            // å‰µå»ºå°èˆªé»
            const dotsContainer = document.createElement('div');
            dotsContainer.className = 'slideshow-dots';
            CONFIG.slideshow.images.forEach((_, index) => {
                const dot = document.createElement('span');
                dot.className = 'slideshow-dot' + (index === 0 ? ' active' : '');
                dot.addEventListener('click', (e) => {
                    e.stopPropagation();
                    goToSlide(index);
                });
                dotsContainer.appendChild(dot);
            });
            container.appendChild(dotsContainer);

            // é–‹å§‹è‡ªå‹•æ’­æ”¾
            startSlideshow();
        }

        function goToSlide(index) {
            const slides = document.querySelectorAll('.slideshow-slide');
            const dots = document.querySelectorAll('.slideshow-dot');

            if (!slides.length) return;

            // ç§»é™¤ç•¶å‰ active
            slides[currentSlide].classList.remove('active');
            dots[currentSlide].classList.remove('active');

            // è¨­ç½®æ–°çš„ active
            currentSlide = index;
            slides[currentSlide].classList.add('active');
            dots[currentSlide].classList.add('active');
        }

        function nextSlide() {
            const slides = document.querySelectorAll('.slideshow-slide');
            if (!slides.length) return;

            const next = (currentSlide + 1) % slides.length;
            goToSlide(next);
        }

        function startSlideshow() {
            if (slideInterval) clearInterval(slideInterval);
            slideInterval = setInterval(nextSlide, CONFIG.slideshow.interval);
        }

        function stopSlideshow() {
            if (slideInterval) {
                clearInterval(slideInterval);
                slideInterval = null;
            }
        }

        // Lightbox å…¨è¢å¹•é è¦½åŠŸèƒ½
        let currentLightboxIndex = 0;

        function openLightbox(index) {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            const lightboxCurrent = document.getElementById('lightbox-current');
            const lightboxTotal = document.getElementById('lightbox-total');

            currentLightboxIndex = index;
            lightboxImg.src = CONFIG.slideshow.images[index];
            lightboxCurrent.textContent = index + 1;
            lightboxTotal.textContent = CONFIG.slideshow.images.length;

            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»¾å‹•

            // æš«åœå¹»ç‡ˆç‰‡è‡ªå‹•æ’­æ”¾
            stopSlideshow();
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
            document.body.style.overflow = ''; // æ¢å¾©æ»¾å‹•

            // æ¢å¾©å¹»ç‡ˆç‰‡è‡ªå‹•æ’­æ”¾
            startSlideshow();
        }

        function changeLightboxImage(direction) {
            const total = CONFIG.slideshow.images.length;
            currentLightboxIndex = (currentLightboxIndex + direction + total) % total;

            const lightboxImg = document.getElementById('lightbox-img');
            const lightboxCurrent = document.getElementById('lightbox-current');

            lightboxImg.src = CONFIG.slideshow.images[currentLightboxIndex];
            lightboxCurrent.textContent = currentLightboxIndex + 1;
        }

        // éµç›¤å¿«æ·éµ
        document.addEventListener('keydown', function(e) {
            const lightbox = document.getElementById('lightbox');
            if (!lightbox.classList.contains('active')) return;

            if (e.key === 'Escape') {
                closeLightbox();
            } else if (e.key === 'ArrowLeft') {
                changeLightboxImage(-1);
            } else if (e.key === 'ArrowRight') {
                changeLightboxImage(1);
            }
        });

        // é»æ“ŠèƒŒæ™¯é—œé–‰ Lightbox
        document.getElementById('lightbox').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLightbox();
            }
        });

        // åˆå§‹åŒ– AOS æ»¾å‹•å‹•ç•«
        AOS.init({
            duration: 1000,
            once: false,
            offset: 100
        });

        // æ»¾å‹•æ™‚è‡ªå‹•é«˜äº®å°èˆªåˆ—
        function updateActiveNavLink() {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link');

            let currentSection = '';
            const scrollPosition = window.scrollY + 150; // å¢åŠ åç§»é‡ä»¥ææ—©è§¸ç™¼

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;

                if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                    currentSection = section.getAttribute('id');
                }
            });

            // ç§»é™¤æ‰€æœ‰ active é¡åˆ¥
            navLinks.forEach(link => {
                link.classList.remove('active');

                // å¦‚æœé€£çµå°æ‡‰ç•¶å‰å€å¡Šï¼Œæ·»åŠ  active é¡åˆ¥
                if (link.getAttribute('href') === '#' + currentSection) {
                    link.classList.add('active');
                }
            });
        }

        // ç›£è½æ»¾å‹•äº‹ä»¶
        window.addEventListener('scroll', updateActiveNavLink);

        // åœ°é»æŒ‰éˆ•åˆ‡æ›åœ°åœ–
        function initLocationButtons() {
            const locationButtons = document.querySelectorAll('.location-btn');
            const mapIframe = document.getElementById('venue-map');

            // è¨­ç½®åˆå§‹åœ°åœ–ç‚ºç¬¬ä¸€å€‹åœ°é»
            const firstVenue = Object.values(CONFIG.venues)[0];
            if (firstVenue) {
                mapIframe.src = firstVenue.mapUrl;
            }

            locationButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active é¡åˆ¥
                    locationButtons.forEach(btn => btn.classList.remove('active'));

                    // æ·»åŠ ç•¶å‰æŒ‰éˆ•çš„ active é¡åˆ¥
                    this.classList.add('active');

                    // æ›´æ–°åœ°åœ–
                    const location = this.getAttribute('data-location');
                    if (CONFIG.venues[location]) {
                        mapIframe.src = CONFIG.venues[location].mapUrl;
                    }
                });
            });
        }

        // é é¢è¼‰å…¥å®Œæˆå¾ŒåŸ·è¡Œ
        window.addEventListener('load', function() {
            // åˆå§‹åŒ–é é¢å…§å®¹
            initPageContent();

            // åˆå§‹åŒ–å°èˆªé«˜äº®
            updateActiveNavLink();

            // åˆå§‹åŒ–åœ°é»æŒ‰éˆ•
            initLocationButtons();

            // åˆ¤æ–·æ˜¯å¦é¡¯ç¤ºå„€ç¯€è¡¨ï¼ˆ2/7 12:00 ä¹‹å¾Œéƒ½é¡¯ç¤ºï¼‰
            function isSpecialPeriod() {
                return true;
            }

            // é¡¯ç¤ºæ­¡è¿å½ˆçª—
            Swal.fire({
                title: CONFIG.welcomePopup.title,
                html: CONFIG.welcomePopup.text.replace(/\n/g, '<br>'),
                confirmButtonText: 'é€²å…¥',
                confirmButtonColor: '#d4a574',
                allowOutsideClick: false,
                allowEscapeKey: false,
                showClass: {
                    popup: 'animate__animated animate__fadeInDown animate__faster'
                },
                hideClass: {
                    popup: 'animate__animated animate__fadeOutUp animate__faster'
                },
                customClass: {
                    popup: 'custom-popup',
                    title: 'custom-title',
                    htmlContainer: 'custom-text',
                    confirmButton: 'custom-confirm-button'
                },
                backdrop: 'rgba(0,0,0,0.7)'
            }).then((result) => {
                if (result.isConfirmed) {
                    // æ’­æ”¾èƒŒæ™¯éŸ³æ¨‚ä¸¦æ·¡å…¥
                    fadeInMusic();

                    // åªåœ¨å©šç¦®æœŸé–“ï¼ˆ2/7 12:00 ~ 2/8 12:00ï¼‰é¡¯ç¤ºç¬¬äºŒå€‹å½ˆçª—
                    const now = new Date();
                    const startTime = CONFIG.ceremonySchedule.startTime;
                    const endTime = CONFIG.ceremonySchedule.endTime;
                    const isDuringCeremony = now >= startTime && now <= endTime;

                    if (isDuringCeremony) {
                        setTimeout(() => {
                            showCeremonySchedulePrompt();
                        }, 500);
                    }
                }
            });

            // ç¬¬äºŒå½ˆçª—ï¼šè©¢å•æ˜¯å¦æŸ¥çœ‹å„€ç¯€è¡¨
            function showCeremonySchedulePrompt() {
                Swal.fire({
                    title: 'ğŸŠ å©šç¦®å„€ç¯€è¡¨',
                    html: 'å©šç¦®å³å°‡é–‹å§‹ï¼<br>æ˜¯å¦æŸ¥çœ‹è©³ç´°å„€ç¯€è¡¨ï¼Ÿ',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'æŸ¥çœ‹å„€ç¯€è¡¨',
                    cancelButtonText: 'ç¨å¾Œå†èªª',
                    confirmButtonColor: '#d4a574',
                    cancelButtonColor: '#999',
                    customClass: {
                        popup: 'custom-popup',
                        confirmButton: 'custom-confirm-button',
                        cancelButton: 'custom-cancel-button'
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        openCeremonySchedule(0);
                    }
                });
            }
        });

        // éŸ³æ¨‚æ·¡å…¥å‡½å¼
        function fadeInMusic() {
            const music = document.getElementById('bg-music');
            music.volume = 0;
            music.play();

            let volume = 0;
            const maxVolume = 0.7;  // æœ€å¤§éŸ³é‡ 70%
            const fadeDuration = 2000;  // æ·¡å…¥æ™‚é–“ 2 ç§’
            const steps = 20;
            const volumeStep = maxVolume / steps;
            const timeStep = fadeDuration / steps;

            const fadeInterval = setInterval(function() {
                if (volume < maxVolume) {
                    volume += volumeStep;
                    music.volume = Math.min(volume, maxVolume);
                } else {
                    clearInterval(fadeInterval);
                }
            }, timeStep);

            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            updateMusicButton(true);
        }

        // éŸ³æ¨‚æ§åˆ¶æŒ‰éˆ•åŠŸèƒ½
        function initMusicControl() {
            const musicBtn = document.getElementById('music-toggle');
            const music = document.getElementById('bg-music');
            const musicIcon = musicBtn.querySelector('.music-icon');

            musicBtn.addEventListener('click', function() {
                if (music.paused) {
                    // æ’­æ”¾éŸ³æ¨‚
                    if (music.currentTime === 0) {
                        fadeInMusic();
                    } else {
                        music.volume = 0.7;
                        music.play();
                        updateMusicButton(true);
                    }
                } else {
                    // æš«åœéŸ³æ¨‚
                    music.pause();
                    updateMusicButton(false);
                }
            });

            // ç›£è½éŸ³æ¨‚æ’­æ”¾ç‹€æ…‹è®ŠåŒ–
            music.addEventListener('play', function() {
                updateMusicButton(true);
            });

            music.addEventListener('pause', function() {
                updateMusicButton(false);
            });
        }

        // æ›´æ–°éŸ³æ¨‚æŒ‰éˆ•å¤–è§€
        function updateMusicButton(isPlaying) {
            const musicBtn = document.getElementById('music-toggle');
            const musicIcon = musicBtn.querySelector('.music-icon');

            if (isPlaying) {
                musicIcon.textContent = 'ğŸ”Š';
                musicBtn.classList.add('playing');
            } else {
                musicIcon.textContent = 'ğŸ”‡';
                musicBtn.classList.remove('playing');
            }
        }

        // åˆå§‹åŒ–éŸ³æ¨‚æ§åˆ¶
        initMusicControl();
    </script>

    <script>
        // ========== ç´™æœ¬å–œå¸– Lightboxï¼ˆæ‰‹æ©Ÿå‹å¥½ç‰ˆï¼‰==========
        let currentPaperInvitationIndex = 0;
        let paperInvitationScale = 1;
        let paperInvitationTranslateX = 0;
        let paperInvitationTranslateY = 0;

        // é»æ“Šå°èˆªåˆ—æˆ–é€£çµå€å¡ŠæŒ‰éˆ•æ™‚é–‹å•Ÿ
        document.addEventListener('DOMContentLoaded', function() {
            const paperInvitationLinks = document.querySelectorAll('a[href="#paper-invitation"]');
            paperInvitationLinks.forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    openPaperInvitation(0);
                });
            });
        });

        function openPaperInvitation(index) {
            const lightbox = document.getElementById('paper-invitation-lightbox');
            const img = document.getElementById('paper-invitation-img');
            const current = document.getElementById('paper-invitation-current');
            const total = document.getElementById('paper-invitation-total');

            currentPaperInvitationIndex = index;
            resetImageTransform();

            img.src = CONFIG.paperInvitation.images[index];
            current.textContent = index + 1;
            total.textContent = CONFIG.paperInvitation.images.length;

            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';

            // åˆå§‹åŒ–è§¸æ§æ‰‹å‹¢
            setTimeout(() => initPaperInvitationGestures(), 100);
        }

        function closePaperInvitation() {
            const lightbox = document.getElementById('paper-invitation-lightbox');
            lightbox.classList.remove('active');
            document.body.style.overflow = '';
            resetImageTransform();
        }

        function changePaperInvitationImage(direction) {
            if (paperInvitationScale > 1) return; // æ”¾å¤§æ™‚ä¸åˆ‡æ›

            const total = CONFIG.paperInvitation.images.length;
            currentPaperInvitationIndex = (currentPaperInvitationIndex + direction + total) % total;

            const img = document.getElementById('paper-invitation-img');
            const current = document.getElementById('paper-invitation-current');

            resetImageTransform();
            img.src = CONFIG.paperInvitation.images[currentPaperInvitationIndex];
            current.textContent = currentPaperInvitationIndex + 1;
        }

        function resetImageTransform() {
            paperInvitationScale = 1;
            paperInvitationTranslateX = 0;
            paperInvitationTranslateY = 0;
            updateImageTransform();
        }

        function updateImageTransform() {
            const img = document.getElementById('paper-invitation-img');
            img.style.transform = `scale(${paperInvitationScale}) translate(${paperInvitationTranslateX}px, ${paperInvitationTranslateY}px)`;
            img.style.cursor = paperInvitationScale > 1 ? 'grab' : 'zoom-in';
        }

        // åˆå§‹åŒ–è§¸æ§æ‰‹å‹¢
        function initPaperInvitationGestures() {
            if (typeof Hammer === 'undefined') return; // å¦‚æœ Hammer.js æ²’è¼‰å…¥å°±è·³é

            const img = document.getElementById('paper-invitation-img');

            // å¦‚æœå·²ç¶“åˆå§‹åŒ–éï¼Œå…ˆç§»é™¤
            if (img.hammerInstance) {
                img.hammerInstance.destroy();
            }

            const hammer = new Hammer(img);
            img.hammerInstance = hammer;

            // å•Ÿç”¨ç¸®æ”¾å’Œæ‹–æ›³
            hammer.get('pinch').set({ enable: true });
            hammer.get('pan').set({ direction: Hammer.DIRECTION_ALL });

            let lastScale = 1;
            let lastTranslateX = 0;
            let lastTranslateY = 0;

            // é›™æŒ‡ç¸®æ”¾
            hammer.on('pinchstart', function(e) {
                lastScale = paperInvitationScale;
            });

            hammer.on('pinchmove', function(e) {
                paperInvitationScale = Math.max(1, Math.min(lastScale * e.scale, 4));
                updateImageTransform();
            });

            hammer.on('pinchend', function(e) {
                if (paperInvitationScale < 1.1) {
                    resetImageTransform();
                }
            });

            // æ‹–æ›³ç§»å‹•ï¼ˆæ”¾å¤§å¾Œï¼‰
            hammer.on('panstart', function(e) {
                lastTranslateX = paperInvitationTranslateX;
                lastTranslateY = paperInvitationTranslateY;
                img.style.cursor = 'grabbing';
            });

            hammer.on('panmove', function(e) {
                if (paperInvitationScale > 1) {
                    paperInvitationTranslateX = lastTranslateX + e.deltaX / paperInvitationScale;
                    paperInvitationTranslateY = lastTranslateY + e.deltaY / paperInvitationScale;
                    updateImageTransform();
                }
            });

            hammer.on('panend', function(e) {
                img.style.cursor = paperInvitationScale > 1 ? 'grab' : 'zoom-in';
            });

            // å·¦å³æ»‘å‹•åˆ‡æ›é é¢ï¼ˆæœªæ”¾å¤§æ™‚ï¼‰
            hammer.on('swipeleft', function(e) {
                if (paperInvitationScale <= 1) {
                    changePaperInvitationImage(1);
                }
            });

            hammer.on('swiperight', function(e) {
                if (paperInvitationScale <= 1) {
                    changePaperInvitationImage(-1);
                }
            });

            // é›™æ“Šç¸®æ”¾
            hammer.on('doubletap', function(e) {
                if (paperInvitationScale > 1) {
                    resetImageTransform();
                } else {
                    paperInvitationScale = 2.5;
                    // æ ¹æ“šé»æ“Šä½ç½®èª¿æ•´ä¸­å¿ƒ
                    const rect = img.getBoundingClientRect();
                    const x = e.center.x - rect.left - rect.width / 2;
                    const y = e.center.y - rect.top - rect.height / 2;
                    paperInvitationTranslateX = -x / 2;
                    paperInvitationTranslateY = -y / 2;
                    updateImageTransform();
                }
            });
        }

        // éµç›¤å¿«æ·éµï¼ˆé›»è…¦ï¼‰
        document.addEventListener('keydown', function(e) {
            const lightbox = document.getElementById('paper-invitation-lightbox');
            if (!lightbox.classList.contains('active')) return;

            if (e.key === 'Escape') {
                closePaperInvitation();
            } else if (e.key === 'ArrowLeft') {
                changePaperInvitationImage(-1);
            } else if (e.key === 'ArrowRight') {
                changePaperInvitationImage(1);
            }
        });

        // é»æ“ŠèƒŒæ™¯é—œé–‰ï¼ˆé˜²æ­¢èª¤è§¸ï¼‰
        document.getElementById('paper-invitation-lightbox').addEventListener('click', function(e) {
            if (e.target === this && paperInvitationScale <= 1) {
                closePaperInvitation();
            }
        });
    </script>

    <script>
        // ========== å©šç¦®å„€ç¯€è¡¨ Lightbox ==========
        let currentCeremonyScheduleIndex = 0;

        // æ›´æ–°å°èˆªåˆ—æŒ‰éˆ•ï¼ˆæ ¹æ“šæ™‚é–“ï¼‰
        function updateRSVPLink() {
            const link = document.getElementById('rsvp-or-schedule-link');
            if (!link) return;

            if (isSpecialPeriod()) {
                // ç‰¹æ®ŠæœŸé–“ï¼šæ”¹æˆã€Œå©šç¦®å„€ç¯€è¡¨ã€
                link.textContent = 'å©šç¦®å„€ç¯€è¡¨';
                link.href = '#ceremony-schedule';
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    openCeremonySchedule(0);
                });
            } else {
                // å¹³å¸¸ï¼šä¿æŒã€Œå›è¦†å‡ºå¸­ã€
                link.textContent = 'å›è¦†å‡ºå¸­';
                link.href = '#links';
            }
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            updateRSVPLink();
        });

        function openCeremonySchedule(index) {
            const lightbox = document.getElementById('ceremony-schedule-lightbox');
            const img = document.getElementById('ceremony-schedule-img');
            const current = document.getElementById('ceremony-schedule-current');
            const total = document.getElementById('ceremony-schedule-total');

            currentCeremonyScheduleIndex = index;

            img.src = CONFIG.ceremonySchedule.images[index];
            current.textContent = index + 1;
            total.textContent = CONFIG.ceremonySchedule.images.length;

            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';

            // åˆå§‹åŒ–è§¸æ§æ‰‹å‹¢
            setTimeout(() => initCeremonyScheduleGestures(), 100);
        }

        function closeCeremonySchedule() {
            const lightbox = document.getElementById('ceremony-schedule-lightbox');
            lightbox.classList.remove('active');
            document.body.style.overflow = '';
        }

        function changeCeremonyScheduleImage(direction) {
            const total = CONFIG.ceremonySchedule.images.length;
            currentCeremonyScheduleIndex = (currentCeremonyScheduleIndex + direction + total) % total;

            const img = document.getElementById('ceremony-schedule-img');
            const current = document.getElementById('ceremony-schedule-current');

            img.src = CONFIG.ceremonySchedule.images[currentCeremonyScheduleIndex];
            current.textContent = currentCeremonyScheduleIndex + 1;
        }

        // åˆå§‹åŒ–è§¸æ§æ‰‹å‹¢ï¼ˆè¤‡ç”¨ç´™æœ¬å–œå¸–çš„é‚è¼¯ï¼‰
        function initCeremonyScheduleGestures() {
            if (typeof Hammer === 'undefined') return;

            const img = document.getElementById('ceremony-schedule-img');

            if (img.hammerInstance) {
                img.hammerInstance.destroy();
            }

            const hammer = new Hammer(img);
            img.hammerInstance = hammer;

            hammer.get('pinch').set({ enable: true });
            hammer.get('pan').set({ direction: Hammer.DIRECTION_ALL });

            // å·¦å³æ»‘å‹•åˆ‡æ›
            hammer.on('swipeleft', function(e) {
                changeCeremonyScheduleImage(1);
            });

            hammer.on('swiperight', function(e) {
                changeCeremonyScheduleImage(-1);
            });
        }

        // éµç›¤å¿«æ·éµ
        document.addEventListener('keydown', function(e) {
            const lightbox = document.getElementById('ceremony-schedule-lightbox');
            if (!lightbox.classList.contains('active')) return;

            if (e.key === 'Escape') {
                closeCeremonySchedule();
            } else if (e.key === 'ArrowLeft') {
                changeCeremonyScheduleImage(-1);
            } else if (e.key === 'ArrowRight') {
                changeCeremonyScheduleImage(1);
            }
        });

        // é»æ“ŠèƒŒæ™¯é—œé–‰
        document.getElementById('ceremony-schedule-lightbox').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCeremonySchedule();
            }
        });
    </script>

    <!-- ç•™è¨€æ¿åŠŸèƒ½ -->
    <script src="guestbook.js"></script>
</body>
</html>